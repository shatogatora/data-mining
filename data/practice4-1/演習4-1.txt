でQ1. 時系列データの基礎的分析

Q1-1. 課題データ10-1を読み込み，折れ線グラフに描画せよ．．
Q1-2. 移動平均法を利用した時系列データの成分分解（加法モデル，乗法モデルのそれぞれを仮定），LOESS平滑化を利用した時系列データのSTL分解の実施結果をそれぞれ図示せよ．また，それぞれの結果の違いを考察せよ。

考察
1. 移動平均を利用した加法モデル
観測データ（Observed）: 元の時系列データ。
トレンドデータ（Trend）: 長期的な増加傾向が滑らかに示されています。
季節データ（Seasonal）: 明確な周期パターンが見られます。
残差データ（Residual）: 観測データからトレンドと季節成分を除いた後の変動。

2. 乗法モデル
観測データ（Observed）: 元の時系列データ。
トレンドデータ（Trend）: 長期的な増加傾向が滑らかに示されています。
季節データ（Seasonal）: データの値に比例して変動する季節成分が見られます。
残差データ（Residual）: 観測データからトレンドと季節成分を除いた後の変動。

3. LOESS平滑化
観測データ（Observed）: 元の時系列データ。
トレンドデータ（Trend）: ローカル回帰による滑らかなトレンド成分が示されています。
季節データ（Seasonal）: 明確な周期パターンが見られますが、LOESS平滑化により柔軟な季節変動が強調されます。
残差データ（Residual）: 観測データからトレンドと季節成分を除いた後の変動。

比較と考察
トレンドの違い: 加法モデルと乗法モデル、そしてLOESS平滑化の間でトレンド成分が異なります。加法モデルと乗法モデルでは、トレンド成分は滑らかな増加傾向を示していますが、LOESS平滑化ではローカル回帰により柔軟なトレンドが強調されます。
季節成分の違い: 加法モデルと乗法モデルでは季節成分が異なり、乗法モデルではデータの値に比例して変動する季節成分が見られます。LOESS平滑化では、より柔軟な季節変動が捉えられています。
残差の違い: 各モデルで異なる残差成分が得られます。加法モデルと乗法モデルでは残差が比較的安定していますが、LOESS平滑化では残差成分により柔軟な変動が見られます。

Q1-3. 課題データ10-1から原系列及びその差分系列（1ヶ月），差分系列（12ヶ月）を作成し，グラフで確認せよ．また，それぞれに対してADF検定をせよ．

結果
検定統計量 (Test Statistic) がいずれの臨界値 (Critical Values) よりも大きいため、帰無仮説（単位根が存在する）が棄却されません。
p値が非常に高い（p = 0.9919）ため、データは非定常であると判断されます。
結論: 原系列は単位根を持ち、非定常です。

検定統計量 (Test Statistic) は、5%有意水準の臨界値 (-2.8840) を超えていますが、10%有意水準の臨界値 (-2.5788) を下回っています。
p値が約0.0542で、5%有意水準では帰無仮説を棄却できませんが、10%有意水準では棄却できます。
結論: 1か月差分系列は、5%の有意水準では非定常と見なされますが、10%の有意水準では定常である可能性があります。この結果は境界的であり、さらなる検討が必要です。

検定統計量 (Test Statistic) は、5%有意水準の臨界値 (-2.8840) を下回っており、帰無仮説を棄却できます。
p値が0.0116で、1%および5%の有意水準で帰無仮説（単位根が存在する）を棄却できます。
結論: 12か月差分系列は定常であると判断されます。

Q1-4. 1-3で作成した原系列および差分系列の自己相関と偏自己相関を求め，コレログラムを示せ．．

原系列
ACF（自己相関関数）
ラグが進むにつれて、ゆっくり減衰しています（典型的な非定常系列の特徴）。
強い季節性やトレンドを示唆しており、変換（差分など）が必要です。

PACF（偏自己相関関数）
初期のラグ（特にラグ1）が大きく、以降は急激に減衰しています。
これも非定常性を示唆しており、差分を取ることで定常化できる可能性があります。

1ヶ月差分系列
ACF
初期のラグで明確なピークが見られるが、全体的に速やかに収束しています。
これは、1ヶ月差分によってトレンド成分がほぼ除去されていることを示唆しています。

PACF
ラグ1付近で強いピークがありますが、それ以降のラグでは収束が見られます。
短期的な自己相関が残っているため、AR成分（p=1または2）を考慮する必要があります。

12ヶ月差分系列
ACF
季節的なラグ（12ヶ月ごと）で顕著なピークが見られます。
これは、季節性成分が強く残っていることを示唆しており、SARIMAモデルの季節項を考慮すべきです。

PACF
季節的なラグ（12ヶ月ごと）で顕著なピークがあります。
季節性AR成分（P）を考慮する必要があります。


パラメータの選定方針
差分次数 (d)
ADF検定とACFの結果から、1回差分 (d=1) で定常性が達成されていると判断できます。

自己回帰項 (p)
PACFに基づき、ラグ1または2にピークがあるため、p は 1～2 の値を試すのが良いでしょう。

移動平均項 (q)
ACFに基づき、ラグ1にピークがあるため、q は 1 または 2 を試す価値があります。

候補モデル
ARIMA(1, 1, 1)
ARIMA(2, 1, 1)
ARIMA(1, 1, 2)
ARIMA(2, 1, 2)

Q1-5. データセットdfをテストデータtest（直近12ヶ月）とトレーニングデータtrainに分割し，分割点をグラフに描画せよ．
Q1-6. ARIMAモデルを用いて予測モデルを学習し，その結果を示せ．

ARIMA(1, 1, 1)
AIC: 1257.035
BIC: 1265.661
モデル精度は比較的低く、改良の余地があります。

ARIMA(2, 1, 1)
AIC: 1246.262
BIC: 1257.763
ARIMA(1, 1, 1)よりも改善されていますが、さらなる改善が可能です。

ARIMA(1, 1, 2)
AIC: 1252.974
BIC: 1264.474
AIC・BICがARIMA(2, 1, 1)より高いため、候補から外れます。

ARIMA(2, 1, 2)
AIC: 1225.563
BIC: 1239.939
最も良好なモデルです。AIC・BICが最小で、全パラメータが有意 (P値 < 0.05) です

Q1-7. テストデータを用いて予測モデルのRMSE，MAE，MAPEを求めよ．

各モデルの比較

ARIMA(2, 1, 2)
RMSE: 55.22（最小）
MAE: 41.83（最小）
MAPE: 8.22%（最小）

全体的な精度が他モデルよりも優れており、予測誤差が最小。
他のモデル（ARIMA(1, 1, 1), ARIMA(2, 1, 1), ARIMA(1, 1, 2), ARIMA(2, 3, 1)）は、RMSE、MAE、MAPEのいずれもARIMA(2, 1, 2)より大きい値を示しており、予測精度が劣る。

ARIMA(2, 1, 2)の採用理由
RMSE、MAE、MAPEのすべてで最小値を記録。
モデルのパラメータ（AR, MA成分）が統計的に有意であり（P値 < 0.05）、妥当性が確認されている。
過差分や過剰な複雑性がないため、将来予測にも適している。